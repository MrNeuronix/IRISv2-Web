#{extends 'main.html' /}
#{set title:'Скрипты' /}

<style type="text/css" media="screen">
    #editor {
        position: relative;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        min-height: 500px;
    }
</style>

<div>
    <ul class="breadcrumb">
        <li>
            <a href="/">Главная</a> <span class="divider">/</span>
        </li>
        <li>
            <a href="/scripts">Скрипты</a> <span class="divider">/</span>
        </li>
        <li>
            <a href="#">Новый скрипт</a>
        </li>
    </ul>
</div>

<div class="row-fluid sortable">
    <div class="box span12">
        <div class="box-header well" data-original-title>
            <h2><i class="icon-picture"></i> Редактирование скрипта</h2>
            <div class="box-icon">
                <a href="#" class="btn btn-setting btn-round"><i class="icon-cog"></i></a>
                <a href="#" class="btn btn-minimize btn-round"><i class="icon-chevron-up"></i></a>
                <a href="#" class="btn btn-close btn-round"><i class="icon-remove"></i></a>
            </div>
        </div>
        <div class="box-content">

        <form class="form-horizontal" method="POST" action="/scripts/save">
        <fieldset>
            <div class="control-group">
                <label class="control-label" for="focusedInput">Имя скрипта</label>
                <div class="controls">
                    <input class="input-xlarge focused" id="focusedInput" type="text" name="name" value="new-script.js">
                </div>
            </div>
            <input type="hidden" name="jscode" style="display: none;">
            <div id="editor">${body}</div>
        <br>
        <div class="form-actions">
                <button type="submit" class="btn btn-primary">Сохранить</button>
                <button class="btn">Отменить</button>
        </div>
        </fieldset>
        </form>

        </div>
    </div><!--/span-->
</div><!--/row-->

<script src="http://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js" type="text/javascript" charset="utf-8"></script>

<script>
    var editor = ace.edit('editor');
    editor.session.setMode("ace/mode/javascript");
    editor.setTheme("ace/theme/chrome");

    var input = $('input[name="jscode"]');
    editor.getSession().on("change", function () {
        input.val(editor.getSession().getValue());
    });
</script>